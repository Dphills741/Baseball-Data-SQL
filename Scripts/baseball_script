--Question 1 Started in 1871 ended in 2016
select max(yearid) as last_year,
min(yearid) as start_year
from appearances

--Question 2 Eddie Gaedel 43 inches, Team SLA and 1 game
select namefirst, 
namelast, 
height,
teamid,
g_all
from people as p
inner join appearances as a
on p.playerid = a.playerid
where height is not null and a.playerid = 'gaedeed01'
group by namefirst, namelast, height, teamid, g_all
order by height 

--Question 3 David Price with a salary of 81 mil
select p.playerid,
namefirst, 
namelast,
schoolid,
MONEY(CAST(SUM(DISTINCT salary) AS numeric)) AS total_salary
from people as p
left join collegeplaying as c
on c.playerid = p.playerid
left join salaries as s
on p.playerid = s.playerid
where schoolid = 'vandy' and salary is not null
group by p.playerid, namefirst,namelast,schoolid
order by total_salary desc

--Question 4 58934 Infield, 41424 Battery, 29560 Outfield
select 
sum(po),
case when pos = 'OF' then 'Outfield'
when pos = 'P' then 'Battery'
when pos = 'C' then 'Battery'
else 'Infield' end as new_position
from fielding
where yearid = 2016
group by new_position 
order by sum(po) desc

--Question 5 
select ROUND(CAST(SUM(so) AS DECIMAL)/CAST(SUM(g)/2 AS DECIMAL), 2) AS avg_strikeouts,
    ROUND(CAST(SUM(hr) AS DECIMAL)/CAST(SUM(g)/2 AS DECIMAL), 2) AS avg_homeruns,
yearid/10 * 10 as decade
from teams 
where so is not null and yearid >= 1920
group by decade
order by decade 


--Question 6 owingch01 has avg_success of 0.91
select attempts,
sb,
playerid,
round((cast(sb as numeric)/cast(attempts as numeric)),2) as avg_success
from
    (select (sb+cs) as attempts,
     sb,
     playerid
    from batting 
    where yearid = 2016 and sb > 0) as subquery
where attempts >= 20
order by avg_success desc


--Question 7 sea won 116 did not win world series
select teamid,
w
from teams 
where yearid between 1970 and 2016 and wswin = 'N'
order by w desc

--extended 1981 all teams had low games, SLN had 83
select teamid,
w 
from teams
where (yearid between 1970 and 2016) and wswin = 'Y' and yearid != 1981
order by w 

-- probably wrong
select 
max(w),
yearid
from teams
where (yearid between 1970 and 2016) and yearid != 1981
group by yearid
order by max(w) desc


select 
max(w),
yearid
from teams
where (yearid between 1970 and 2016) and yearid != 1981 and wswin = 'Y'
group by yearid
order by max(w) desc

--Question 8
--Top 5
select round((attendance/games),2) as avg_attendance,
park,
team
from homegames
where year = 2016 and games >= 10
group by park,team,games,attendance
order by avg_attendance desc
limit 5
--Bottom 5
select round((attendance/games),2) as avg_attendance,
park,
team
from homegames
where year = 2016 and games >= 10
group by park,team,games,attendance
order by avg_attendance 
limit 5

--Question 9

select distinct(a1.playerid),
a1.awardid,
a1.lgid,
a2.lgid,
namefirst,
namelast,
teamid
from awardsmanagers as a1
join awardsmanagers as a2
on a1.playerid = a2.playerid
join people as p
on a1.playerid = p.playerid
join salaries as s
on a1.playerid = s.playerid
where a1.awardid like '%TSN%' and a1.lgid = 'NL' and a2.lgid ='AL'
--Question 10 







select * 
from teams


select schoolname, schoolid
from schools
where schoolname like '%Vand%'